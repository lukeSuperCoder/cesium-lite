# Skill: plugin-analysis

对 CesiumLite 地图功能插件进行全面的需求分析，生成结构化的需求文档。

## 使用场景

当需要为 CesiumLite 项目开发新的功能插件时，使用此 skill 进行系统化的需求分析，确保功能设计完整、API 合理、实现可行。

## 使用方式

```bash
/plugin-analysis <功能插件名称>
```

例如：
- `/plugin-analysis 地形裁剪功能`
- `/plugin-analysis 三维测量工具`
- `/plugin-analysis 图层切换器`
- `/plugin-analysis 飞行漫游`

## 工作流程

### 第一阶段：基础信息收集

通过交互式问答收集插件的基本信息：

#### 1. 功能概述
- **插件中文名称**：如"地形裁剪功能"
- **插件英文名称**：如 TerrainClip（用于类名和文件名）
- **功能简介**：一句话描述插件的核心功能
- **目标用户**：谁会使用这个功能？（开发者、业务人员等）
- **核心价值**：解决什么问题？带来什么价值？

#### 2. 应用场景分析
询问并记录 3-5 个典型应用场景：
- 场景 1：具体的使用场景描述
- 场景 2：具体的使用场景描述
- 场景 3：具体的使用场景描述

#### 3. 功能范围界定
- **核心功能**：必须实现的功能（列表形式）
- **扩展功能**：可选的增强功能（列表形式）
- **不包含功能**：明确不在此插件范围内的功能

### 第二阶段：技术设计分析

#### 1. 对标分析
- **Cesium 原生实现**：使用 Cesium 原生 API 如何实现？有哪些痛点？
- **同类产品调研**：其他类似库是如何实现的？
- **差异化优势**：CesiumLite 的封装有什么优势？

#### 2. 技术可行性评估
- **依赖的 Cesium API**：需要用到哪些 Cesium 核心类和方法？
- **第三方依赖**：是否需要引入额外的 npm 包？
- **浏览器兼容性**：是否有特殊的浏览器要求？
- **性能考量**：可能的性能瓶颈和优化方案？
- **技术风险**：有哪些技术难点和风险？

#### 3. 模块分类
根据功能特性确定插件所属类别：
- **图层类**（layers/）：管理各类地图图层
- **控件类**（controls/）：UI 交互控件
- **相机类**（camera/）：相机控制与动画
- **标绘类**（mark/）：绘制与测量工具
- **实体类**（entity/）：实体管理与操作
- **分析类**（analysis/）：空间分析工具
- **效果类**（effects/）：视觉效果与后处理
- **工具类**（utils/）：通用工具函数
- **其他**：创建新的分类

### 第三阶段：API 设计规划

#### 1. 类设计
设计插件的核心类结构，包括构造函数、公共方法和内部状态管理。

#### 2. API 方法列表
为每个公共方法设计：
- **方法名称**：驼峰命名
- **功能描述**：简要说明方法的作用
- **参数列表**：参数名、类型、说明、是否必需
- **返回值**：类型和说明
- **使用示例**：简单的代码示例

#### 3. 配置项设计
设计插件的默认配置选项，使用对象形式定义。

#### 4. 事件/回调设计
如果插件需要事件机制，设计事件名称、触发时机和回调参数。

### 第四阶段：实现方案设计

#### 1. 核心实现思路
- **整体架构**：模块如何组织？使用什么设计模式？
- **关键算法**：核心算法的实现思路
- **状态管理**：如何管理内部状态？使用什么数据结构？
- **生命周期**：初始化、使用、销毁的流程

#### 2. 与其他模块的交互
- **依赖模块**：需要调用哪些现有模块？
- **被依赖关系**：会被哪些模块使用？
- **数据流向**：数据如何在模块间传递？

#### 3. 资源管理
- **资源创建**：创建哪些 Cesium 对象？
- **资源释放**：如何清理资源避免内存泄漏？
- **重复调用处理**：如何处理方法的重复调用？

#### 4. 错误处理
- **参数验证**：如何验证输入参数？
- **异常捕获**：可能抛出哪些异常？
- **错误提示**：如何给开发者友好的错误信息？

### 第五阶段：示例页面规划

#### 1. 示例文件信息
- **文件路径**：examples/[示例名称].html
- **页面标题**：展示什么内容？
- **演示功能点**：列出页面演示的所有功能

#### 2. UI 设计
- **交互控件**：需要哪些按钮、输入框、选择器？
- **信息展示**：需要显示哪些信息？
- **布局方式**：控件如何布局？

#### 3. 演示数据
- **测试数据**：使用什么数据进行演示？
- **数据来源**：数据从哪里获取？

### 第六阶段：开发规划

#### 1. 开发步骤
1. 创建功能分支：git checkout -b feature-[功能名]
2. 创建插件文件：src/[分类]/[文件名].js
3. 实现核心类和方法
4. 在 src/index.js 中集成
5. 创建示例页面：examples/[示例名].html
6. 更新 vite.config.js 添加示例入口
7. 本地测试和调试
8. 编写使用文档
9. 提交代码和合并分支

#### 2. 工作量评估
- **核心功能开发**：预估复杂度（简单/中等/复杂）
- **示例页面**：预估复杂度（简单/中等/复杂）
- **文档编写**：预估复杂度（简单/中等/复杂）
- **测试调试**：预估复杂度（简单/中等/复杂）

#### 3. 风险与挑战
- **技术挑战**：列出可能遇到的技术难点
- **依赖风险**：第三方库或 API 的风险
- **性能风险**：可能的性能问题

#### 4. 后续优化方向
- **性能优化**：可以优化的地方
- **功能扩展**：未来可以添加的功能
- **体验改进**：可以改进的用户体验

## 输出文档格式

完成分析后，将生成一份 Markdown 格式的需求文档，保存在 docs/需求分析/[插件名称]-需求分析.md
