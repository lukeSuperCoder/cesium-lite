# npm åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰ç®¡ç†æŒ‡å—

## ğŸ”“ å¦‚ä½•å…³é—­ 2FA

### æ–¹å¼ä¸€ï¼šé€šè¿‡ç½‘é¡µå…³é—­ï¼ˆæ¨èï¼‰

1. è®¿é—® npm ç½‘ç«™å¹¶ç™»å½•ï¼šhttps://www.npmjs.com/login
2. è¿›å…¥è´¦æˆ·è®¾ç½®ï¼šhttps://www.npmjs.com/settings/YOUR_USERNAME/tfa
3. æˆ–è€…ç‚¹å‡»ï¼šå¤´åƒ â†’ Account â†’ Two-Factor Authentication
4. æ‰¾åˆ° "Two-Factor Authentication" éƒ¨åˆ†
5. ç‚¹å‡» **"Disable 2FA"** æˆ– **"Remove 2FA"**
6. è¾“å…¥å½“å‰çš„ 6 ä½éªŒè¯ç ç¡®è®¤
7. å®Œæˆï¼

### æ–¹å¼äºŒï¼šé€šè¿‡å‘½ä»¤è¡Œå…³é—­

```bash
# å…³é—­ 2FA
npm profile disable-2fa

# ä¼šæç¤ºè¾“å…¥å½“å‰çš„ OTP éªŒè¯ç 
```

---

## âš ï¸ å…³é—­ 2FA çš„å½±å“

### å®‰å…¨æ€§é™ä½
- âŒ è´¦æˆ·å®‰å…¨æ€§é™ä½
- âŒ å¦‚æœå¯†ç æ³„éœ²ï¼Œè´¦æˆ·å¯èƒ½è¢«ç›—ç”¨
- âŒ å‘å¸ƒçš„åŒ…å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹

### æ“ä½œæ›´æ–¹ä¾¿
- âœ… å‘å¸ƒæ—¶æ— éœ€è¾“å…¥éªŒè¯ç 
- âœ… ç™»å½•æ›´ç®€å•
- âœ… è‡ªåŠ¨åŒ–è„šæœ¬æ›´å®¹æ˜“å®ç°

---

## ğŸ” 2FA çš„ä¸‰ç§æ¨¡å¼

npm æä¾›ä¸‰ç§ 2FA æ¨¡å¼ï¼š

### 1. ç¦ç”¨ï¼ˆNoneï¼‰
```bash
npm profile disable-2fa
```
- å®Œå…¨å…³é—­ 2FA
- ä¸æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒ

### 2. ä»…è®¤è¯æ¨¡å¼ï¼ˆAuth-onlyï¼‰
```bash
npm profile enable-2fa auth-only
```
- âœ… åªåœ¨ç™»å½•æ—¶éœ€è¦ 2FA
- âœ… å‘å¸ƒåŒ…æ—¶**ä¸éœ€è¦** 2FA
- â­ **æ¨èç»™å¼€å‘è€…ä½¿ç”¨**

### 3. è®¤è¯å’Œå†™å…¥æ¨¡å¼ï¼ˆAuth-and-writesï¼‰
```bash
npm profile enable-2fa auth-and-writes
```
- ç™»å½•æ—¶éœ€è¦ 2FA
- å‘å¸ƒåŒ…æ—¶ä¹Ÿéœ€è¦ 2FA
- å®‰å…¨æ€§æœ€é«˜ï¼Œä½†æ“ä½œæœ€éº»çƒ¦

---

## ğŸ¯ æ¨èæ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ Auth-only æ¨¡å¼ â­â­â­ å¼ºçƒˆæ¨è

è¿™æ˜¯æœ€ä½³å¹³è¡¡æ–¹æ¡ˆï¼šæ—¢ä¿è¯ç™»å½•å®‰å…¨ï¼Œåˆæ–¹ä¾¿å‘å¸ƒã€‚

```bash
# 1. å…ˆå…³é—­å½“å‰çš„ 2FA
npm profile disable-2fa
# è¾“å…¥éªŒè¯ç ç¡®è®¤

# 2. å¯ç”¨ Auth-only æ¨¡å¼
npm profile enable-2fa auth-only
# æŒ‰æç¤ºé…ç½® 2FA

# 3. ä»¥åå‘å¸ƒæ— éœ€ OTP
npm publish --access public
```

**ä¼˜åŠ¿ï¼š**
- âœ… ç™»å½•æ—¶ä¿æŠ¤è´¦æˆ·å®‰å…¨
- âœ… å‘å¸ƒæ—¶æ— éœ€éªŒè¯ç 
- âœ… è‡ªåŠ¨åŒ–è„šæœ¬å¯ä»¥æ­£å¸¸å·¥ä½œ

### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨è®¿é—®ä»¤ç‰Œï¼ˆä¿æŒ Auth-and-writesï¼‰

ä¿æŒæœ€é«˜å®‰å…¨çº§åˆ«ï¼Œä½†ä½¿ç”¨ä»¤ç‰Œç»•è¿‡ 2FAï¼š

```bash
# 1. åˆ›å»º Automation ç±»å‹çš„è®¿é—®ä»¤ç‰Œ
# è®¿é—®ï¼šhttps://www.npmjs.com/settings/YOUR_USERNAME/tokens

# 2. é…ç½®ä»¤ç‰Œ
echo "//registry.npmjs.org/:_authToken=<ä»¤ç‰Œ>" >> ~/.npmrc

# 3. ä»¥åå‘å¸ƒæ— éœ€ OTP
npm publish --access public
```

### æ–¹æ¡ˆä¸‰ï¼šå®Œå…¨å…³é—­ 2FAï¼ˆä¸æ¨èï¼‰

å¦‚æœä½ ç¡®å®šè¦å…³é—­ï¼š

```bash
npm profile disable-2fa
# è¾“å…¥éªŒè¯ç ç¡®è®¤
```

---

## ğŸ“ æ“ä½œæ­¥éª¤è¯¦è§£

### å…³é—­å½“å‰çš„ 2FA

```bash
# æ–¹å¼ 1ï¼šå‘½ä»¤è¡Œ
npm profile disable-2fa

# æ–¹å¼ 2ï¼šç½‘é¡µ
# è®¿é—®ï¼šhttps://www.npmjs.com/settings/YOUR_USERNAME/tfa
# ç‚¹å‡» "Disable 2FA"
```

### å¯ç”¨ Auth-only æ¨¡å¼ï¼ˆæ¨èï¼‰

```bash
# 1. å¯ç”¨ Auth-only
npm profile enable-2fa auth-only

# 2. æŒ‰æç¤ºæ‰«æäºŒç»´ç æˆ–è¾“å…¥å¯†é’¥
#    ä½¿ç”¨ä½ çš„ 2FA Appï¼ˆGoogle Authenticator ç­‰ï¼‰

# 3. è¾“å…¥ 6 ä½éªŒè¯ç ç¡®è®¤

# 4. ä¿å­˜æ¢å¤ä»£ç ï¼ˆéå¸¸é‡è¦ï¼ï¼‰
```

### éªŒè¯å½“å‰ 2FA çŠ¶æ€

```bash
# æŸ¥çœ‹è´¦æˆ·ä¿¡æ¯
npm profile get

# æŸ¥çœ‹ 2FA çŠ¶æ€
npm profile get tfa
```

---

## ğŸ”„ åˆ‡æ¢åˆ° Auth-only æ¨¡å¼çš„å®Œæ•´æµç¨‹

### æ­¥éª¤ 1ï¼šæŸ¥çœ‹å½“å‰çŠ¶æ€

```bash
npm profile get tfa
# ä¼šæ˜¾ç¤ºï¼šauth-and-writes æˆ– disabled
```

### æ­¥éª¤ 2ï¼šå…³é—­ç°æœ‰ 2FA

```bash
npm profile disable-2fa
```

ä¼šæç¤ºï¼š
```
Enter one-time password: ______
```
è¾“å…¥ä½  2FA App ä¸­çš„ 6 ä½éªŒè¯ç ã€‚

### æ­¥éª¤ 3ï¼šå¯ç”¨ Auth-only æ¨¡å¼

```bash
npm profile enable-2fa auth-only
```

ä¼šæ˜¾ç¤ºäºŒç»´ç ï¼Œä½¿ç”¨ 2FA App æ‰«æã€‚

### æ­¥éª¤ 4ï¼šç¡®è®¤è®¾ç½®

è¾“å…¥ 2FA App æ˜¾ç¤ºçš„éªŒè¯ç ç¡®è®¤ã€‚

### æ­¥éª¤ 5ï¼šä¿å­˜æ¢å¤ä»£ç 

ç³»ç»Ÿä¼šæ˜¾ç¤ºæ¢å¤ä»£ç ï¼Œ**åŠ¡å¿…ä¿å­˜**ï¼å¦‚æœä¸¢å¤±æ‰‹æœºï¼Œæ¢å¤ä»£ç æ˜¯å”¯ä¸€çš„æ•‘å‘½ç¨»è‰ã€‚

### æ­¥éª¤ 6ï¼šæµ‹è¯•å‘å¸ƒ

```bash
npm publish --access public
# åº”è¯¥ä¸å†æç¤ºè¾“å…¥ OTP
```

---

## ğŸ’¡ å®é™…å»ºè®®

æ ¹æ®ä½ çš„æƒ…å†µï¼Œæˆ‘æ¨èï¼š

### å¯¹äºä¸ªäººé¡¹ç›®ï¼ˆå¦‚ cesium-liteï¼‰

**æ¨èï¼šAuth-only æ¨¡å¼**

```bash
# åˆ‡æ¢åˆ° Auth-only
npm profile disable-2fa  # è¾“å…¥éªŒè¯ç 
npm profile enable-2fa auth-only  # é‡æ–°é…ç½®

# ä»¥åå‘å¸ƒå°±ç®€å•äº†
npm run release:patch  # æ— éœ€ OTP
```

### å¯¹äºå›¢é˜Ÿ/ä¼ä¸šé¡¹ç›®

**æ¨èï¼šä½¿ç”¨è®¿é—®ä»¤ç‰Œ + Auth-and-writes**

ä¿æŒæœ€é«˜å®‰å…¨æ€§ï¼Œä½¿ç”¨ CI/CD ä»¤ç‰Œè‡ªåŠ¨åŒ–ã€‚

---

## ğŸš¨ å®‰å…¨è­¦å‘Š

### å¦‚æœå®Œå…¨å…³é—­ 2FA

- âš ï¸ ç¡®ä¿å¯†ç è¶³å¤Ÿå¼ºï¼ˆå»ºè®®ä½¿ç”¨å¯†ç ç®¡ç†å™¨ç”Ÿæˆï¼‰
- âš ï¸ ä¸è¦åœ¨å…¬å…±è®¾å¤‡ä¸Šç™»å½•
- âš ï¸ å®šæœŸæ›´æ¢å¯†ç 
- âš ï¸ ç›‘æ§è´¦æˆ·æ´»åŠ¨

### æ¨èçš„å®‰å…¨å®è·µ

1. **ä½¿ç”¨ Auth-only æ¨¡å¼**
   - æ—¢ä¿è¯å®‰å…¨åˆæ–¹ä¾¿å‘å¸ƒ

2. **ä½¿ç”¨å¼ºå¯†ç **
   - è‡³å°‘ 16 ä½
   - åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦
   - ä½¿ç”¨å¯†ç ç®¡ç†å™¨ï¼ˆ1Passwordã€LastPass ç­‰ï¼‰

3. **ä¿å­˜æ¢å¤ä»£ç **
   - æ‰“å°å‡ºæ¥æ”¾åœ¨å®‰å…¨çš„åœ°æ–¹
   - æˆ–ä¿å­˜åœ¨å¯†ç ç®¡ç†å™¨ä¸­

4. **å®šæœŸæ£€æŸ¥è´¦æˆ·æ´»åŠ¨**
   - è®¿é—®ï¼šhttps://www.npmjs.com/settings/YOUR_USERNAME/tokens
   - æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„ç™»å½•æˆ–å‘å¸ƒè®°å½•

---

## ğŸ“‹ å¿«é€Ÿæ“ä½œæŒ‡å—

### ç«‹å³è§£å†³å‘å¸ƒé—®é¢˜ï¼ˆæ¨èï¼‰

```bash
# 1. å…³é—­å½“å‰çš„ Auth-and-writes æ¨¡å¼
npm profile disable-2fa
# è¾“å…¥éªŒè¯ç 

# 2. å¯ç”¨ Auth-only æ¨¡å¼
npm profile enable-2fa auth-only
# æ‰«æäºŒç»´ç å¹¶ç¡®è®¤

# 3. æµ‹è¯•å‘å¸ƒï¼ˆå½“å‰ç‰ˆæœ¬æ˜¯ 1.2.3ï¼‰
npm publish --access public
# æˆåŠŸï¼æ— éœ€ OTP
```

### å®Œå…¨å…³é—­ 2FAï¼ˆä¸æ¨èï¼‰

```bash
npm profile disable-2fa
# è¾“å…¥éªŒè¯ç 

# å®Œæˆï¼ä½†å®‰å…¨æ€§é™ä½
```

---

## ğŸ”— ç›¸å…³å‘½ä»¤é€ŸæŸ¥

```bash
# æŸ¥çœ‹è´¦æˆ·ä¿¡æ¯
npm profile get

# æŸ¥çœ‹ 2FA çŠ¶æ€
npm profile get tfa

# å…³é—­ 2FA
npm profile disable-2fa

# å¯ç”¨ Auth-only
npm profile enable-2fa auth-only

# å¯ç”¨ Auth-and-writes
npm profile enable-2fa auth-and-writes

# æŸ¥çœ‹æ‰€æœ‰è®¿é—®ä»¤ç‰Œ
npm token list

# åˆ›å»ºæ–°ä»¤ç‰Œ
npm token create --read-only
npm token create --cidr=192.168.1.1/24
```

---

## ğŸ‰ æ€»ç»“

### æœ€ä½³æ–¹æ¡ˆï¼ˆå¼ºçƒˆæ¨èï¼‰

**åˆ‡æ¢åˆ° Auth-only æ¨¡å¼**ï¼Œè¿™æ ·ï¼š
- âœ… ç™»å½•æ—¶ä»æœ‰ 2FA ä¿æŠ¤
- âœ… å‘å¸ƒæ—¶æ— éœ€éªŒè¯ç 
- âœ… è‡ªåŠ¨åŒ–è„šæœ¬å¯ä»¥æ­£å¸¸å·¥ä½œ
- âœ… å®‰å…¨æ€§å’Œä¾¿åˆ©æ€§å…¼é¡¾

### æ“ä½œå‘½ä»¤

```bash
npm profile disable-2fa      # è¾“å…¥éªŒè¯ç 
npm profile enable-2fa auth-only  # æ‰«æäºŒç»´ç 
npm publish --access public  # æµ‹è¯•å‘å¸ƒï¼Œæ— éœ€ OTP
```

å®Œæˆåï¼Œä½ å°±å¯ä»¥æ„‰å¿«åœ°ä½¿ç”¨ `npm run release:patch` äº†ï¼ğŸš€
