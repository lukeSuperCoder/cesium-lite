const C=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}};C();class g{constructor(e,t={}){this.viewer=null,this.containerId=e,this.options={},this.options=Object.assign(this.options,t),this.initializeMap()}initializeMap(){return this.viewer=new Cesium.Viewer(this.containerId,this.options),this.viewer}}class y{constructor(e,t){this.viewer=e,this.camera=e.camera,this.options=t,this.initializeCameraControl(this.options)}initializeCameraControl(e){this.viewer.camera.setView({destination:Cesium.Cartesian3.fromDegrees(e.longitude,e.latitude,e.height),orientation:{heading:Cesium.Math.toRadians(e.heading),pitch:Cesium.Math.toRadians(e.pitch),roll:Cesium.Math.toRadians(e.roll)}})}flyTo(e){const{longitude:t,latitude:i,height:s=1e3,duration:o=3,heading:n=0,pitch:r=-90,roll:l=0}=e;this.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(t,i,s),orientation:{heading:Cesium.Math.toRadians(n),pitch:Cesium.Math.toRadians(r),roll:Cesium.Math.toRadians(l)},duration:o})}setView(e){const{longitude:t,latitude:i,height:s=1e3,heading:o=0,pitch:n=-90,roll:r=0}=e;this.camera.setView({destination:Cesium.Cartesian3.fromDegrees(t,i,s),orientation:{heading:Cesium.Math.toRadians(o),pitch:Cesium.Math.toRadians(n),roll:Cesium.Math.toRadians(r)}})}getPosition(){const e=Cesium.Cartographic.fromCartesian(this.camera.position);return{longitude:Cesium.Math.toDegrees(e.longitude),latitude:Cesium.Math.toDegrees(e.latitude),height:e.height,heading:Cesium.Math.toDegrees(this.camera.heading),pitch:Cesium.Math.toDegrees(this.camera.pitch),roll:Cesium.Math.toDegrees(this.camera.roll)}}setOrientation(e){const{heading:t,pitch:i,roll:s}=e;t!==void 0&&this.camera.setHeading(Cesium.Math.toRadians(t)),i!==void 0&&this.camera.setPitch(Cesium.Math.toRadians(i)),s!==void 0&&this.camera.setRoll(Cesium.Math.toRadians(s))}move(e){const{distance:t,direction:i}=e,s=Cesium.Math.toRadians(i);this.camera.position;const o=new Cesium.Cartesian3(Math.sin(s)*t,Math.cos(s)*t,0);this.camera.move(o)}rotate(e){const{heading:t,pitch:i,roll:s}=e;t!==void 0&&this.camera.rotateRight(Cesium.Math.toRadians(t)),i!==void 0&&this.camera.rotateUp(Cesium.Math.toRadians(i)),s!==void 0&&this.camera.rotateDown(Cesium.Math.toRadians(s))}}class f{constructor(e,t={}){this.viewer=e,this.options=t,this.basemaps=new Map,this.currentBasemap=null,this.initializeBasemaps()}async initializeBasemaps(){await this.addDefaultBasemaps();const e=this.options.id||"imagery";this.switchBasemap(e)}async addDefaultBasemaps(){const e=await Cesium.createWorldImageryAsync();this.addBasemap("imagery",{id:"imagery",name:"\u5F71\u50CF\u5E95\u56FE",provider:e,visible:!1}),this.addBasemap("osm",{id:"osm",name:"OpenStreetMap",provider:new Cesium.OpenStreetMapImageryProvider({url:"https://tile.openstreetmap.org/"}),visible:!1}),this.addBasemap("gaode",{id:"gaode",name:"\u9AD8\u5FB7\u5E95\u56FE",provider:new Cesium.UrlTemplateImageryProvider({url:"https://webrd01.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",minimumLevel:0,maximumLevel:18}),visible:!1})}addBasemap(e,t){const{name:i,provider:s,visible:o=!1}=t,n=new Cesium.ImageryLayer(s,{show:o});this.basemaps.set(e,{id:e,name:i,layer:n,provider:s}),this.viewer.imageryLayers.add(n)}removeBasemap(e){const t=this.basemaps.get(e);t&&(this.viewer.imageryLayers.remove(t.layer),this.basemaps.delete(e),this.currentBasemap===e&&this.switchBasemap("imagery"))}async switchBasemap(e){const t=this.basemaps.get(e);if(!t){console.warn(`\u5E95\u56FE ${e} \u4E0D\u5B58\u5728`);return}this.basemaps.forEach(i=>{i.layer.show=!1}),t.layer.show=!0,this.currentBasemap=e,await this.viewer.scene.requestRender()}getBasemapList(){return Array.from(this.basemaps.values()).map(e=>({id:e.id,name:e.name,visible:e.layer.show}))}getCurrentBasemap(){return this.currentBasemap?this.basemaps.get(this.currentBasemap):null}setBasemapBrightness(e,t){const i=this.basemaps.get(e);i&&(t=Math.max(0,Math.min(10,t)),i.layer&&(i.layer.brightness=t),i.layer.imageryLayers&&i.layer.imageryLayers.forEach(s=>{s.brightness=t}))}addWMTSBasemap(e,t){const i=new Cesium.WebMapTileServiceImageryProvider({url:t.url,layer:t.layer,style:t.style,format:t.format,tileMatrixSetID:t.tileMatrixSetID});this.addBasemap(e,{name:t.name||e,provider:i,visible:!1})}addBingMapsBasemap(e,t){const i=new Cesium.BingMapsImageryProvider({url:"https://dev.virtualearth.net",key:t.key,mapStyle:t.mapStyle});this.addBasemap(e,{name:t.name||e,provider:i,visible:!1})}destroy(){this.basemaps.clear(),this.currentBasemap=null}}class v{constructor(e,t={}){this.viewer=e,this.options=t,this.container=null,this.initialize()}initialize(){this.container=document.createElement("div"),this.container.className="map-control fullscreen-control",this.container.innerHTML=`
            <button class="fullscreen-toggle" title="\u5168\u5C4F">\u2922</button>
        `,this.container.querySelector(".fullscreen-toggle").onclick=()=>this.toggleFullscreen(),document.addEventListener("fullscreenchange",()=>this.updateButtonState()),this.viewer.container.appendChild(this.container)}toggleFullscreen(){document.fullscreenElement?document.exitFullscreen():this.viewer.container.requestFullscreen()}updateButtonState(){const e=this.container.querySelector(".fullscreen-toggle");e.innerHTML=document.fullscreenElement?"\u2913":"\u2922"}show(){this.container.style.display="block"}hide(){this.container.style.display="none"}setPosition(e){this.container.className=`map-control fullscreen-control ${e}`}destroy(){document.removeEventListener("fullscreenchange",this.updateButtonState),this.container.remove()}}class w{constructor(e,t={}){this.viewer=e,this.options=t,this.container=null,this.zoomLevels=[5e7,3e7,1e7,5e6,1e6,5e5,1e5,5e4,1e4,5e3,1e3],this.currentZoomIndex=0,this.initialize()}initialize(){this.container=document.createElement("div"),this.container.className="map-control zoom-control",this.container.innerHTML=`
            <button class="zoom-in" title="\u653E\u5927">+</button>
            <button class="zoom-out" title="\u7F29\u5C0F">-</button>
        `,this.container.querySelector(".zoom-in").onclick=()=>this.zoomIn(),this.container.querySelector(".zoom-out").onclick=()=>this.zoomOut(),this.viewer.container.appendChild(this.container)}getZoom(){return this.zoomLevels[this.currentZoomIndex]}setZoom(e){if(e>0&&(this.currentZoomIndex=e>this.zoomLevels.length?this.zoomLevels.length-1:e,this.currentZoomIndex>0)){this.currentZoomIndex--;const t=this.zoomLevels[this.currentZoomIndex];this.getCameraCenterPosition()&&this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromRadians(this.viewer.camera.positionCartographic.longitude,this.viewer.camera.positionCartographic.latitude,t),duration:1.5})}}getCameraCenterPosition(){const e=this.viewer.scene.canvas,t=new Cesium.Cartesian2(e.clientWidth/2,e.clientHeight/2);return this.viewer.camera.pickEllipsoid(t,this.viewer.scene.globe.ellipsoid)}zoomOut(){if(this.currentZoomIndex=this.calculateZoomIndex(),this.currentZoomIndex>0){this.currentZoomIndex--;const e=this.zoomLevels[this.currentZoomIndex];this.getCameraCenterPosition()&&this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromRadians(this.viewer.camera.positionCartographic.longitude,this.viewer.camera.positionCartographic.latitude,e),duration:1.5})}}zoomIn(){if(this.currentZoomIndex=this.calculateZoomIndex(),this.currentZoomIndex<this.zoomLevels.length-1){this.currentZoomIndex++;const e=this.zoomLevels[this.currentZoomIndex];this.getCameraCenterPosition()&&this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromRadians(this.viewer.camera.positionCartographic.longitude,this.viewer.camera.positionCartographic.latitude,e),duration:1.5})}}show(){this.container.style.display="block"}hide(){this.container.style.display="none"}setPosition(e){this.container.className=`map-control zoom-control ${e}`}destroy(){this.container.remove()}calculateZoomIndex(){const e=this.viewer.camera.positionCartographic.height;let t=0,i=Math.abs(this.zoomLevels[0]-e);return this.zoomLevels.forEach((s,o)=>{const n=Math.abs(s-e);n<i&&(i=n,t=o)}),t}}class _{constructor(e,t={}){this.viewer=e,this.options=t,this.container=null,this.initialize()}initialize(){this.container=document.createElement("div"),this.container.className="map-control scale-control",this.updateScale=()=>{const e=this.getScaleDistance();this.container.innerHTML=`\u6BD4\u4F8B\u5C3A 1:${Math.round(e).toLocaleString()}`},this.viewer.camera.changed.addEventListener(this.updateScale),this.updateScale(),this.viewer.container.appendChild(this.container)}getScaleDistance(){const e=this.viewer.canvas.clientWidth,t=this.viewer.canvas.clientHeight,i=this.viewer.camera.getPickRay({x:0,y:t/2}),s=this.viewer.camera.getPickRay({x:e,y:t/2}),o=this.viewer.scene.globe,n=o.pick(i,this.viewer.scene),r=o.pick(s,this.viewer.scene);return!n||!r?0:Cesium.Cartesian3.distance(n,r)}show(){this.container.style.display="block"}hide(){this.container.style.display="none"}setPosition(e){this.container.className=`map-control scale-control ${e}`}destroy(){this.viewer.camera.changed.removeEventListener(this.updateScale),this.container.remove()}}class m{constructor(e,t={}){var i,s,o;this.viewer=e,this._drawHandler=null,this._dataSource=null,this._tempPositions=[],this._mousePos=null,this._drawType=null,this._originalCursor=null,this.defaultStyles={point:{color:Cesium.Color.RED,pixelSize:10,outlineColor:Cesium.Color.YELLOW,outlineWidth:2},polyline:{color:Cesium.Color.RED,width:3,material:new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.YELLOW}),depthFailMaterial:new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.YELLOW})},polygon:{color:Cesium.Color.RED,width:3,fillColor:Cesium.Color.RED.withAlpha(.4),material:new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.YELLOW}),depthFailMaterial:new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.YELLOW})}},this.options={styles:{point:{...this.defaultStyles.point,...((i=t.styles)==null?void 0:i.point)||{}},polyline:{...this.defaultStyles.polyline,...((s=t.styles)==null?void 0:s.polyline)||{}},polygon:{...this.defaultStyles.polygon,...((o=t.styles)==null?void 0:o.polygon)||{}}}}}draw(e,t){this.clearAll(),this._drawType=e,this._dataSource=new Cesium.CustomDataSource("_dataSource"),this.viewer.dataSources.add(this._dataSource),this._originalCursor=this.viewer.container.style.cursor,this.viewer.container.style.cursor="crosshair",this._registerEvents(t)}_registerEvents(e){switch(this._drawHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.viewer.scene.globe.depthTestAgainstTerrain=!0,this._drawType){case"Point":{this._leftClickEventForPoint();break}case"Polyline":{this._leftClickEventForPolyline(),this._mouseMoveEventForPolyline(),this._rightClickEventForPolyline(e),this._doubleClickEventForPolyline(e);break}case"Polygon":{this._leftClickEventForPolygon(),this._mouseMoveEventForPolygon(),this._rightClickEventForPolygon(e),this._doubleClickEventForPolygon(e);break}}}_leftClickEventForPoint(){this._drawHandler.setInputAction(e=>{let t=this.viewer.scene.pickPosition(e.position);if(!t)return;let i=Cesium.Cartographic.fromCartesian(t),s=[Cesium.Math.toDegrees(i.longitude),Cesium.Math.toDegrees(i.latitude),i.height+50];this._addPoint(s)},Cesium.ScreenSpaceEventType.LEFT_CLICK)}_leftClickEventForPolyline(){this._drawHandler.setInputAction(e=>{let t=this.viewer.scene.pickPosition(e.position);!t||(this._tempPositions.push(t),this._addPolyline())},Cesium.ScreenSpaceEventType.LEFT_CLICK)}_mouseMoveEventForPolyline(){this._drawHandler.setInputAction(e=>{let t=this.viewer.scene.pickPosition(e.endPosition);!t||(this._mousePos=t)},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}_rightClickEventForPolyline(e){this._drawHandler.setInputAction(t=>{!this.viewer.scene.pickPosition(t.position)||(this._removeAllEvent(),this._dataSource.entities.removeAll(),this._dataSource.entities.add({polyline:{positions:this._tempPositions,clampToGround:!0,...this.options.styles.polyline}}))},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}_doubleClickEventForPolyline(e){this._drawHandler.setInputAction(t=>{if(!this.viewer.scene.pickPosition(t.position))return;this._removeAllEvent();const s=this._dataSource.entities.add({polyline:{positions:this._tempPositions,clampToGround:!0,...this.options.styles.polyline}});e&&typeof e=="function"&&e(s)},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}_leftClickEventForPolygon(){this._drawHandler.setInputAction(e=>{let t=this.viewer.scene.pickPosition(e.position);!t||(this._tempPositions.push(t),this._addPolygon())},Cesium.ScreenSpaceEventType.LEFT_CLICK)}_mouseMoveEventForPolygon(){this._drawHandler.setInputAction(e=>{let t=this.viewer.scene.pickPosition(e.endPosition);!t||(this._mousePos=t)},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}_rightClickEventForPolygon(e){this._drawHandler.setInputAction(t=>{if(!this.viewer.scene.pickPosition(t.position))return;if(this._tempPositions.length<3){alert("\u8BF7\u81F3\u5C11\u7ED8\u52363\u4E2A\u70B9\u6765\u6784\u6210\u4E00\u4E2A\u9762");return}this._tempPositions.push(this._tempPositions[0]),this._removeAllEvent(),this._dataSource.entities.removeAll();const s=this._dataSource.entities.add({polyline:{positions:this._tempPositions,clampToGround:!0,...this.options.styles.polygon},polygon:{hierarchy:this._tempPositions,extrudedHeightReference:Cesium.HeightReference.CLAMP_TO_GROUND,material:this.options.styles.polygon.fillColor,clampToGround:!0}});e&&typeof e=="function"&&e(s)},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}_doubleClickEventForPolygon(e){this._drawHandler.setInputAction(t=>{if(!this.viewer.scene.pickPosition(t.position))return;if(this._tempPositions.length<3){alert("\u8BF7\u81F3\u5C11\u7ED8\u52363\u4E2A\u70B9\u6765\u6784\u6210\u4E00\u4E2A\u9762");return}this._tempPositions.push(this._tempPositions[0]),this._removeAllEvent(),this._dataSource.entities.removeAll();const s=this._dataSource.entities.add({polyline:{positions:this._tempPositions,clampToGround:!0,...this.options.styles.polygon},polygon:{hierarchy:this._tempPositions,extrudedHeightReference:Cesium.HeightReference.CLAMP_TO_GROUND,material:this.options.styles.polygon.fillColor,clampToGround:!0}});e&&typeof e=="function"&&e(s)},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}_removeAllEvent(){this._drawHandler&&(this._drawHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler.removeInputAction(Cesium.ScreenSpaceEventType.RIGHT_CLICK),this._drawHandler.destroy(),this._drawHandler=null),this._originalCursor!==null&&(this.viewer.container.style.cursor=this._originalCursor,this._originalCursor=null)}_resetParams(){this._dataSource!=null&&(this._dataSource.entities.removeAll(),this.viewer.dataSources.remove(this._dataSource)),this._dataSource=null,this._tempPositions=[],this._mousePos=null,this._drawType=null,this._originalCursor&&(this.viewer.container.style.cursor=this._originalCursor,this._originalCursor=null)}clearAll(){this._removeAllEvent(),this._resetParams()}_addPoint(e){this._dataSource.entities.add({position:Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2]),point:this.options.styles.point})}_addPolyline(){this._dataSource.entities.add({polyline:{positions:new Cesium.CallbackProperty(()=>{let e=Array.from(this._tempPositions);return this._mousePos&&e.push(this._mousePos),e},!1),clampToGround:!0,...this.options.styles.polyline}})}_addPolygon(){this._tempPositions.length==1?this._dataSource.entities.add({polyline:{positions:new Cesium.CallbackProperty(()=>{let e=Array.from(this._tempPositions);return this._mousePos&&e.push(this._mousePos),e},!1),clampToGround:!0,...this.options.styles.polygon}}):(this._dataSource.entities.removeAll(),this._dataSource.entities.add({polygon:{hierarchy:new Cesium.CallbackProperty(()=>{let e=Array.from(this._tempPositions);return this._mousePos&&e.push(this._mousePos),new Cesium.PolygonHierarchy(e)},!1),extrudedHeightReference:Cesium.HeightReference.CLAMP_TO_GROUND,material:this.options.styles.polygon.fillColor,clampToGround:!0},polyline:{positions:new Cesium.CallbackProperty(()=>{let e=Array.from(this._tempPositions);return this._mousePos&&(e.push(this._mousePos),e.push(e[0])),e},!1),clampToGround:!0,...this.options.styles.polygon}}))}}class P{constructor(e,t={}){this.viewer=e,this.drawTool=new m(e,t),this._measureEntities=new Map,this._measureLabels=new Map,this._currentMeasureId=null,this._measureCount=0}measureDistance(e){this.clearAll(),this._measureCount++,this._currentMeasureId=`distance_${this._measureCount}`,this.drawTool.draw("Polyline",t=>{const i=t.polyline.positions.getValue(),s=this._calculateDistance(i);this._measureEntities.set(this._currentMeasureId,t);const o=i[i.length-1],n=this._createLabel([o],s);this._measureLabels.set(this._currentMeasureId,n),e&&e({id:this._currentMeasureId,distance:s,positions:i})})}measureArea(e){this._measureCount++,this._currentMeasureId=`area_${this._measureCount}`,this.drawTool.draw("Polygon",t=>{const i=t.polygon.hierarchy.getValue().positions,s=this._calculateArea(i);this._measureEntities.set(this._currentMeasureId,t);const o=this._calculatePolygonCenter(i),n=this._createLabel([o],s,!0);this._measureLabels.set(this._currentMeasureId,n),e&&e({id:this._currentMeasureId,area:s,positions:i})})}clearAll(){this._measureEntities.forEach(e=>{this.viewer.entities.remove(e)}),this._measureEntities.clear(),this._measureLabels.forEach(e=>{this.viewer.entities.remove(e)}),this._measureLabels.clear(),this.drawTool.clearAll(),this._currentMeasureId=null,this._measureCount=0}clear(e){this._measureEntities.has(e)&&(this.viewer.entities.remove(this._measureEntities.get(e)),this._measureEntities.delete(e)),this._measureLabels.has(e)&&(this.viewer.entities.remove(this._measureLabels.get(e)),this._measureLabels.delete(e))}_calculateDistance(e){let t=0;for(let i=0;i<e.length-1;i++){const s=e[i],o=e[i+1];t+=this._getDistance(s,o)}return t}_calculateArea(e){let t=0;const i=e.map(s=>{const o=Cesium.Cartographic.fromCartesian(s);return{longitude:Cesium.Math.toDegrees(o.longitude),latitude:Cesium.Math.toDegrees(o.latitude)}});for(let s=0;s<i.length;s++){const o=(s+1)%i.length;t+=i[s].longitude*i[o].latitude,t-=i[o].longitude*i[s].latitude}return t=Math.abs(t)*111.32*111.32*Math.cos(i[0].latitude*Math.PI/180)/2,t}_getDistance(e,t){const i=Cesium.Cartographic.fromCartesian(e),s=Cesium.Cartographic.fromCartesian(t),o=Cesium.Math.toDegrees(i.longitude),n=Cesium.Math.toDegrees(i.latitude),r=Cesium.Math.toDegrees(s.longitude),l=Cesium.Math.toDegrees(s.latitude),d=6371,h=(l-n)*Math.PI/180,c=(r-o)*Math.PI/180,u=Math.sin(h/2)*Math.sin(h/2)+Math.cos(n*Math.PI/180)*Math.cos(l*Math.PI/180)*Math.sin(c/2)*Math.sin(c/2),p=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return d*p}_createLabel(e,t,i=!1){const s=e[0],o=i?`${t.toFixed(2)} \u5E73\u65B9\u516C\u91CC`:`${t.toFixed(2)} \u516C\u91CC`;return this.viewer.entities.add({position:s,label:{text:o,font:"14px sans-serif",fillColor:Cesium.Color.WHITE,outlineColor:Cesium.Color.BLACK,outlineWidth:2,verticalOrigin:1,pixelOffset:new Cesium.Cartesian2(0,-10),showBackground:!0,backgroundColor:new Cesium.Color(.165,.165,.165,.8),backgroundPadding:new Cesium.Cartesian2(7,5),disableDepthTestDistance:Number.POSITIVE_INFINITY}})}_calculatePolygonCenter(e){let t=0,i=0,s=0;e.forEach(r=>{t+=r.x,i+=r.y,s+=r.z});const o=new Cesium.Cartesian3(t/e.length,i/e.length,s/e.length),n=Cesium.Cartographic.fromCartesian(o);return Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,n.height)}}class E{constructor(e={}){this.id=e.id||Cesium.createGuid(),this.options=Object.assign({},e),this.entity=new Cesium.Entity(this.options)}update(e){Object.assign(this.options,e),this.entity.update(this.options)}getEntity(){return this.entity}}class M{constructor(e){if(!e)throw new Error("Viewer instance is required");this.viewer=e,this.dataSource=new Cesium.CustomDataSource("entityManager"),this.viewer.dataSources.add(this.dataSource),this.entities=new Map}addEntity(e,t=!1){const i=new E(e);return this.entities.set(i.id,i),this.dataSource.entities.add(i.getEntity()),t&&this.locateEntity(i.id),i.id}removeEntity(e){if(this.entities.has(e)){const t=this.entities.get(e);this.dataSource.entities.remove(t.getEntity()),this.entities.delete(e)}}updateEntity(e,t){this.entities.has(e)&&this.entities.get(e).update(t)}locateEntity(e){if(this.entities.has(e)){const t=this.entities.get(e);this.viewer.zoomTo(t.getEntity())}}getAllEntities(){return Array.from(this.entities.values()).map(e=>e.getEntity())}clearEntities(){this.dataSource.entities.removeAll(),this.entities.clear()}}const S={token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3YjgzNGY1ZS05YjM3LTRlMDgtOGExZS0wMjBjMjYwN2QxYzAiLCJpZCI6MjgxODAzLCJpYXQiOjE3NDEyNTc1ODN9.q3kRxAWSoC8gCfU_qRrNcjOqTDDfPqGJTEPE1J7d7-w"};class L{constructor(e,t={}){Cesium.Ion.defaultAccessToken=S.token;const i={containerId:e,fullscreenButton:!1,baseLayerPicker:!1,vrButton:!1,timeline:!1,animation:!1,homeButton:!1,geocoder:!1,navigationHelpButton:!1,sceneModePicker:!1,baseLayerPicker:!1,map:{baseMap:{id:"vector"},terrain:{provider:"CesiumIon",requestVertexNormals:!0,requestWaterMask:!0},camera:{longitude:116.397428,latitude:39.90923,height:1e6,heading:0,pitch:-90,roll:0},controls:{zoomAmount:1e4,zoom:!0,scale:!0,fullscreen:!0},drawStyles:{}}};this.options=this.deepMerge(i,t),this.mapCore=new g(e,this.options),this.cameraControl=new y(this.mapCore.viewer,this.options.map.camera),this.basemapControl=new f(this.mapCore.viewer,this.options.map.baseMap),this.fullscreenControl=new v(this.mapCore.viewer,this.options.map.controls),this.zoomControl=new w(this.mapCore.viewer,this.options.map.controls),this.scaleControl=new _(this.mapCore.viewer,this.options.map.controls),this.drawTool=new m(this.mapCore.viewer,{styles:this.options.map.drawStyles}),this.measureTool=new P(this.mapCore.viewer),this.entityManager=new M(this.mapCore.viewer),this.options.map.controls.fullscreen?(this.fullscreenControl.show(),this.fullscreenControl.setPosition("top-right")):this.fullscreenControl.hide(),this.options.map.controls.zoom?(this.zoomControl.show(),this.zoomControl.setPosition("top-left")):this.zoomControl.hide(),this.options.map.controls.scale?(this.scaleControl.show(),this.scaleControl.setPosition("bottom-right")):this.scaleControl.hide(),window.cesiumInstance=this,window.Cesium=Cesium}deepMerge(e,t){const i={...e};for(const s in t)t[s]instanceof Object&&!Array.isArray(t[s])?s in e?i[s]=this.deepMerge(e[s],t[s]):i[s]={...t[s]}:t[s]!==void 0&&(i[s]=t[s]);return i}flyTo(e){return this.cameraControl.flyTo(e)}setView(e){return this.cameraControl.setView(e)}getPosition(){return this.cameraControl.getPosition()}setOrientation(e){return this.cameraControl.setOrientation(e)}move(e){return this.cameraControl.move(e)}rotate(e){return this.cameraControl.rotate(e)}}window.CesiumLite=L;
